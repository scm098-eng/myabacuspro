{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase-admin.ts"],"sourcesContent":["\nimport * as admin from 'firebase-admin';\n\n// This utility ensures that the Firebase Admin SDK is initialized only once\n// across all server-side requests in a serverless environment.\n\ninterface FirebaseAdmin {\n  auth: admin.auth.Auth;\n  firestore: admin.firestore.Firestore;\n  storage: admin.storage.Storage;\n}\n\nif (!admin.apps.length) {\n  try {\n    admin.initializeApp({\n      credential: admin.credential.applicationDefault(),\n      storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    });\n    console.log('Firebase Admin SDK initialized successfully.');\n  } catch (error) {\n    console.error('Firebase Admin SDK initialization error:', error);\n  }\n}\n\nconst auth = admin.auth();\nconst firestore = admin.firestore();\nconst storage = admin.storage();\n\nexport function getFirebaseAdmin(): FirebaseAdmin {\n  return { auth, firestore, storage };\n}\n"],"names":[],"mappings":";;;AACA;;AAWA,IAAI,CAAC,2HAAA,CAAA,OAAU,CAAC,MAAM,EAAE;IACtB,IAAI;QACF,CAAA,GAAA,2HAAA,CAAA,gBAAmB,AAAD,EAAE;YAClB,YAAY,2HAAA,CAAA,aAAgB,CAAC,kBAAkB;YAC/C,eAAe,QAAQ,GAAG,CAAC,mCAAmC;QAChE;QACA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4CAA4C;IAC5D;AACF;AAEA,MAAM,OAAO,CAAA,GAAA,2HAAA,CAAA,OAAU,AAAD;AACtB,MAAM,YAAY,CAAA,GAAA,2HAAA,CAAA,YAAe,AAAD;AAChC,MAAM,UAAU,CAAA,GAAA,2HAAA,CAAA,UAAa,AAAD;AAErB,SAAS;IACd,OAAO;QAAE;QAAM;QAAW;IAAQ;AACpC","debugId":null}},
    {"offset": {"line": 244, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/api/create-subscription/route.ts"],"sourcesContent":["\nimport { NextRequest, NextResponse } from 'next/server';\nimport Razorpay from 'razorpay';\nimport { getFirebaseAdmin } from '@/lib/firebase-admin';\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\n\nconst razorpay = new Razorpay({\n  key_id: process.env.NEXT_PUBLIC_RAZORPAY_KEY_ID!,\n  key_secret: process.env.RAZORPAY_KEY_SECRET!,\n});\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { planId, firebase_uid } = await req.json();\n\n    if (!planId || !firebase_uid) {\n      return NextResponse.json(\n        { error: 'Missing required fields: planId and firebase_uid' },\n        { status: 400 }\n      );\n    }\n    \n    const { firestore } = getFirebaseAdmin();\n    const userDocRef = doc(firestore, 'users', firebase_uid);\n    const userDoc = await getDoc(userDocRef);\n\n    if (!userDoc.exists()) {\n        return NextResponse.json({ error: 'User not found.' }, { status: 404 });\n    }\n\n    const userData = userDoc.data();\n    \n    const subscriptionOptions = {\n        plan_id: planId,\n        total_count: 12, // For a yearly plan billed monthly\n        quantity: 1,\n        notes: {\n          firebase_uid: firebase_uid,\n        },\n        customer_notify: 1,\n    };\n\n    const subscription = await razorpay.subscriptions.create(subscriptionOptions);\n\n    await setDoc(userDocRef, { razorpaySubscriptionId: subscription.id }, { merge: true });\n\n    return NextResponse.json({\n      subscription_id: subscription.id,\n      status: subscription.status,\n    });\n\n  } catch (error: any) {\n    console.error('[RAZORPAY_CREATE_SUBSCRIPTION_ERROR]', error);\n    return NextResponse.json(\n      { error: error.message || 'Failed to create subscription' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;AACA;AACA;AACA;AACA;AAAA;;;;;AAEA,MAAM,WAAW,IAAI,8IAAA,CAAA,UAAQ,CAAC;IAC5B,MAAM;IACN,YAAY,QAAQ,GAAG,CAAC,mBAAmB;AAC7C;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,IAAI,IAAI;QAE/C,IAAI,CAAC,UAAU,CAAC,cAAc;YAC5B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAmD,GAC5D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,SAAS,EAAE,GAAG,CAAA,GAAA,iIAAA,CAAA,mBAAgB,AAAD;QACrC,MAAM,aAAa,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EAAE,WAAW,SAAS;QAC3C,MAAM,UAAU,MAAM,CAAA,GAAA,mKAAA,CAAA,SAAM,AAAD,EAAE;QAE7B,IAAI,CAAC,QAAQ,MAAM,IAAI;YACnB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,MAAM,WAAW,QAAQ,IAAI;QAE7B,MAAM,sBAAsB;YACxB,SAAS;YACT,aAAa;YACb,UAAU;YACV,OAAO;gBACL,cAAc;YAChB;YACA,iBAAiB;QACrB;QAEA,MAAM,eAAe,MAAM,SAAS,aAAa,CAAC,MAAM,CAAC;QAEzD,MAAM,CAAA,GAAA,mKAAA,CAAA,SAAM,AAAD,EAAE,YAAY;YAAE,wBAAwB,aAAa,EAAE;QAAC,GAAG;YAAE,OAAO;QAAK;QAEpF,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,iBAAiB,aAAa,EAAE;YAChC,QAAQ,aAAa,MAAM;QAC7B;IAEF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAgC,GAC1D;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}