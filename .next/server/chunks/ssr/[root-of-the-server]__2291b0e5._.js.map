{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase-admin.ts"],"sourcesContent":["\nimport * as admin from 'firebase-admin';\n\nexport function getFirebaseAdmin() {\n  if (admin.apps.length > 0) {\n    return admin.app();\n  }\n  return admin.initializeApp();\n}\n"],"names":[],"mappings":";;;AACA;;AAEO,SAAS;IACd,IAAI,2HAAA,CAAA,OAAU,CAAC,MAAM,GAAG,GAAG;QACzB,OAAO,CAAA,GAAA,2HAAA,CAAA,MAAS,AAAD;IACjB;IACA,OAAO,CAAA,GAAA,2HAAA,CAAA,gBAAmB,AAAD;AAC3B","debugId":null}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/updateUserProfile.ts"],"sourcesContent":["\n'use server';\n\nimport { onCall, HttpsError } from 'firebase-functions/v2/https';\nimport { getFirestore, serverTimestamp } from 'firebase-admin/firestore';\nimport { getFirebaseAdmin } from './firebase-admin';\nimport type { ProfileData } from '@/types';\n\ninterface UpdateProfileRequest {\n    data: Partial<ProfileData>;\n}\n\n// Initialize the Firebase Admin SDK\ngetFirebaseAdmin();\n\nexport const updateUserProfile = onCall<UpdateProfileRequest>(async (request) => {\n    if (!request.auth) {\n        throw new HttpsError('unauthenticated', 'The function must be called while authenticated.');\n    }\n\n    const { uid } = request.auth;\n    const { data } = request;\n    \n    const db = getFirestore();\n    const userDocRef = db.collection('users').doc(uid);\n\n    // Sanitize the data to prevent users from updating protected fields\n    const sanitizedData: Partial<ProfileData> = {\n        ...data,\n        updatedAt: serverTimestamp(),\n    };\n    \n    // Explicitly remove any fields a user should not be able to change\n    delete sanitizedData.role;\n    delete sanitizedData.status;\n    delete sanitizedData.subscriptionStatus;\n    delete sanitizedData.isAdmin; // Ensure this can't be set\n    delete (sanitizedData as any).createdAt; // Ensure createdAt is not overwritten\n    delete (sanitizedData as any).uid; // Ensure uid is not changed\n\n    try {\n        await userDocRef.update(sanitizedData);\n        return { success: true, message: 'Profile updated successfully.' };\n    } catch (error: any) {\n        console.error('Error updating profile:', error);\n        throw new HttpsError('internal', 'Could not update profile.', error.message);\n    }\n});\n"],"names":[],"mappings":";;;;;AAGA;AACA;AACA;;;;;;;;;;;AAOA,oCAAoC;AACpC,CAAA,GAAA,+HAAA,CAAA,mBAAgB,AAAD;AAER,MAAM,oBAAoB,CAAA,GAAA,wKAAA,CAAA,SAAM,AAAD,EAAwB,OAAO;IACjE,IAAI,CAAC,QAAQ,IAAI,EAAE;QACf,MAAM,IAAI,wKAAA,CAAA,aAAU,CAAC,mBAAmB;IAC5C;IAEA,MAAM,EAAE,GAAG,EAAE,GAAG,QAAQ,IAAI;IAC5B,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,KAAK,CAAA,GAAA,4JAAA,CAAA,eAAY,AAAD;IACtB,MAAM,aAAa,GAAG,UAAU,CAAC,SAAS,GAAG,CAAC;IAE9C,oEAAoE;IACpE,MAAM,gBAAsC;QACxC,GAAG,IAAI;QACP,WAAW,CAAA,GAAA,4JAAA,CAAA,kBAAe,AAAD;IAC7B;IAEA,mEAAmE;IACnE,OAAO,cAAc,IAAI;IACzB,OAAO,cAAc,MAAM;IAC3B,OAAO,cAAc,kBAAkB;IACvC,OAAO,cAAc,OAAO,EAAE,2BAA2B;IACzD,OAAO,AAAC,cAAsB,SAAS,EAAE,sCAAsC;IAC/E,OAAO,AAAC,cAAsB,GAAG,EAAE,4BAA4B;IAE/D,IAAI;QACA,MAAM,WAAW,MAAM,CAAC;QACxB,OAAO;YAAE,SAAS;YAAM,SAAS;QAAgC;IACrE,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,2BAA2B;QACzC,MAAM,IAAI,wKAAA,CAAA,aAAU,CAAC,YAAY,6BAA6B,MAAM,OAAO;IAC/E;AACJ;;;IAhCa;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/profile/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {updateUserProfile as '7ffd3d1d7b1b66e4029e2cb74be993ce2ba1e1d52d'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/profile/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/profile/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/profile/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA4R,GACzT,0DACA","debugId":null}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/profile/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/profile/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/profile/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAwQ,GACrS,sCACA","debugId":null}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}